program: cs336_basics/training_together.py
method: grid
command:
  - ${env}
  - uv
  - run
  - python
  - ${program}
  - --tokenizer_dir=tokenizer/tiny/
  - --train_path=tokenized/tokenized-tiny-TinyStoriesV2-GPT4-train.bin
  - --valid_path=tokenized/tokenized-tiny-TinyStoriesV2-GPT4-valid.bin
  - --eval_every=500
  - --use_wandb
  - --device=cuda:0
  - --do_compile
  - ${args}
metric:
  name: eval/perplexity
  goal: minimize
parameters:
  batch_size:
    values: [ 4, 8, 16, 32,  64,  128, 256, 512 ]
  alpha_max:
    values: [ 5e-5, 1e-4, 2e-4, 3e-4, 5e-4, 1e-3, 2e-3, 3e-3, 5e-3, 1e-2 ]