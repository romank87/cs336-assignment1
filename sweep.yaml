name: bs-lr-grid-search
program: cs336_basics/training_together.py
method: grid
command:
  - ${env}
  - uv
  - run
  - python
  - ${program}
  - --tokenizer_dir=tokenizer/tiny/
  - --train_path=tokenized/tokenized-tiny-TinyStoriesV2-GPT4-train.bin
  - --valid_path=tokenized/tokenized-tiny-TinyStoriesV2-GPT4-valid.bin
  - --eval_every=1000
  - --use_wandb
  - --device=cuda:0
  - --do_compile
  - ${args}
metric:
  name: eval/perplexity
  goal: minimize
parameters:
  batch_size:
    values: [  32,  64,  128, 256, 512, 8, 16 ]
  alpha_max:
    values: [ 5e-5, 1e-4, 3e-4, 6e-4, 1e-3, 3e-3, 6e-3, 1e-2 ]