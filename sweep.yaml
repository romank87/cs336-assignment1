name: owt-grid-search
program: cs336_basics/training_together.py
method: grid
command:
  - ${env}
  - uv
  - run
  - python
  - ${program}
  - --tokenizer_dir=tokenizer/owt
  - --train_path=tokenized/tokenized-owt-owt_train.bin
  - --valid_path=tokenized/tokenized-owt-owt_valid.bin
  - --eval_every=1000
  - --use_wandb
  - --device=cuda:0
  - --do_compile
  - ${args}
metric:
  name: eval/nll
  goal: minimize
parameters:
  batch_size:
    values: [  32,  64,  128, 256]
  alpha_max:
    values: [ 3e-3, 6e-3, 1e-3 ]